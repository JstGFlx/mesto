(()=>{"use strict";class e{constructor(e,t){this.resetValidityMassage=()=>{this._inputList.forEach((e=>{e.classList.remove(this._inputError)})),this._errors.forEach((e=>{e.textContent=""}))},this._form=document.querySelector(`form[name=${t}]`),this._input=e.inputSelector,this._submitButton=e.submitButtonSelector,this._inactiveButton=e.inactiveButtonClass,this._inputError=e.inputErrorClass,this._errors=this._form.querySelectorAll(e.errorClass)}_showError(e){this._error=this._form.querySelector(`#${e.id}-error`),this._error.textContent=e.validationMessage,e.classList.add(this._inputError)}_hideError(e){this._error=this._form.querySelector(`#${e.id}-error`),this._error.textContent="",e.classList.remove(this._inputError)}_checkInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideError(e):this._showError(e)}_setButtonState(){this._checkInvalidInput()?(this._button.classList.add(this._inactiveButton),this._button.disabled=!0):(this._button.classList.remove(this._inactiveButton),this._button.disabled=!1)}_setEventListener(){this._inputList=[...this._form.querySelectorAll(this._input)],this._button=this._form.querySelector(this._submitButton),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._setButtonState()}))}))}enableValidation(){this._setEventListener(),this._setButtonState()}}class t{constructor({name:e,link:t},s,i){this._title=e,this._image=t,this._template=document.querySelector(s),this._showPopup=i}_getTemplate(){return this._template.content.querySelector(".card").cloneNode(!0)}_likeTheCard(e){e.target.classList.toggle("card__like_active")}_deleteTheCard(e){e.target.closest(".card").remove()}generateCard(){return this._element=this._getTemplate(),this._setEventListeners(),this._elementImage=this._element.querySelector(".card__image"),this._elementImage.src=this._image,this._elementImage.alt=this._title,this._element.querySelector(".card__name").textContent=this._title,this._element}_setEventListeners(){this._element.querySelector(".card__image").addEventListener("click",(()=>{this._showPopup(this._image,this._title)})),this._element.querySelector(".card__like").addEventListener("click",(e=>{this._likeTheCard(e)})),this._element.querySelector(".btn_type_delete").addEventListener("click",(e=>{this._deleteTheCard(e)}))}}class s{constructor(e){this._closeByEscape=e=>{27===e.keyCode&&this.closePopup()},this._closeByClick=e=>{e.target.classList.contains("popup_opened")&&this.closePopup()},this._popup=document.querySelector(e)}openPopup(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._closeByEscape)}closePopup(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._closeByEscape)}setEventListeners(){this._popup.querySelector(".btn_type_close").addEventListener("click",this.closePopup),this._popup.addEventListener("mousedown",(e=>this._closeByClick(e)))}}class i extends s{constructor({submitForm:e},t,s){super(t),this.setEventListeners=()=>{super.setEventListeners(),this._form=this._popup.querySelector(".popup__form"),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submitForm(this._getInputValues()),this.closePopup()}))},this._getInputValues=()=>(this._formValues={},this._inputList.forEach((e=>this._formValues[e.name]=e.value)),this._formValues),this.closePopup=()=>{super.closePopup(),this._form.reset(),this._resetValidityMassage()},this._submitForm=e,this._inputList=this._popup.querySelectorAll(".popup__input"),this._resetValidityMassage=s}setInitialInputsValues(e){this._inputList.forEach((t=>{e[t.name]&&(t.value=e[t.name])}))}}const r={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:".popup__error"},o=document.querySelector(".btn_type_edit"),n=document.querySelector(".btn_type_add"),p=document.querySelector(".cards"),a=new e(r,"edit-profile"),l=new e(r,"add-new-card"),u=new class{constructor({items:e,renderer:t},s){this._renderedItems=e,this._renderer=t,this._container=s}renderItems(){this._renderedItems.forEach((e=>this._renderer(e)))}addItem(e){this._container.append(e)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"},{name:"Ставрополь",link:"https://stv24.tv/wp-content/uploads/2019/12/11/8cc25a94f1fa7968b98fb26b6231b737.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Новочеркасск",link:"https://foto-don.ru/photo/novocherkassk/platov_sobor0.jpg"}],renderer:e=>{const s=new t(e,".template",h.openPopup);u.addItem(s.generateCard())}},p),_=new i({submitForm:e=>{d.setUserInfo(e)}},".popup_type_edit",a.resetValidityMassage),c=new i({submitForm:e=>{const s=new t(e,".template",h.openPopup);p.prepend(s.generateCard())}},".popup_type_add",l.resetValidityMassage),h=new class extends s{constructor(e){super(e),this.openPopup=(e,t)=>{super.openPopup(),this._image.src=e,this._desc.textContent=t,this._image.alt=t},this.closePopup=()=>{super.closePopup()},this._image=this._popup.querySelector(".popup__image"),this._desc=this._popup.querySelector(".popup__description")}}(".popup_type_img"),d=new class{constructor({name:e,aboutMe:t}){this.getUserInfo=()=>(this._profileValues={},this._profileValues.name=this._profileName.textContent,this._profileValues.aboutMe=this._profileAboutMe.textContent,this._profileValues),this.setUserInfo=({name:e,aboutMe:t})=>{this._profileName.textContent=e,this._profileAboutMe.textContent=t},this._profileName=document.querySelector(e),this._profileAboutMe=document.querySelector(t)}}({name:".profile__name",aboutMe:".profile__about-me"});u.renderItems(),_.setEventListeners(),c.setEventListeners(),h.setEventListeners(),o.addEventListener("click",(()=>{_.setInitialInputsValues(d.getUserInfo()),a.enableValidation(),_.openPopup()})),n.addEventListener("click",(()=>{l.enableValidation(),c.openPopup()}))})();